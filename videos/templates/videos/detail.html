{% extends "layout.html" %}

{% block content %}
<div class="row">
  <div class="col-md-8">
    <h3>{{ video.title|default:video.file.name }}</h3>

    <video width="640" height="360" controls>
      <source src="{{ video.file.url }}" type="video/mp4">
      Your browser does not support the video tag.
    </video>

    <p class="mt-3">
      <strong>Uploaded by:</strong> {{ video.uploaded_by }}<br>
      <strong>Uploaded at:</strong> {{ video.uploaded_at }}<br>
      <strong>Size:</strong> {{ video.size }} bytes<br>
      <strong>Hash:</strong> de>{{ video.file_hash }}</code>
    </p>

    <p>{{ video.description|linebreaksbr }}</p>

    {% if user.is_authenticated and (user == video.uploaded_by or user.is_staff) %}
      <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#confirmDeleteModal">
        Delete Video
      </button>
    {% endif %}

    <a class="btn btn-secondary ms-2" href="{% url 'videos:home' %}">Back</a>
  </div>
</div>

<div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form method="post" action="{% url 'videos:delete' video.pk %}">
        {% csrf_token %}
        <div class="modal-header">
          <h5 class="modal-title">Confirm Delete</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          Are you sure you want to delete this video? This action cannot be undone.
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-danger">Yes, Delete</button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
